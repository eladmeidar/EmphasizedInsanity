<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Emphasized Insanity - Ruby on Rails and Oracle on Mac Os Leopard</title>
  <style>
    body { background-color: #fff; color: #333; }

    body, p, ol, ul, td {
      font-family: verdana, arial, helvetica, sans-serif;
      font-size:   13px;
    }

    pre {
      background-color: #eee;
      font-size: 11px;
	  padding:10px;
    }
	
	.gist pre {
		font-size:13px;
	}
	.entry {
		margin-top:10px;
		background:#eee;
		padding:10px;
	}
	
	h2 { margin:0px; padding:0px ;}
    a { font-weight:bolder; color: #000; }
    a:hover { color: #fff; background-color:#000; }
  </style>
</head>
<body>

<h1>
  Exception Caught
  
    in EladMeidar#life
</h1>
<pre>uninitialized constant Insanity</pre>



<p><code>RAILS_ROOT: <a href="http://blog.eizesus.com">http://blog.eizesus.com</a></code></p>

<div id="traces"> 
    <a href="#" onclick="document.getElementById('Framework-Trace').style.display='none';document.getElementById('Full-Trace').style.display='none';document.getElementById('Application-Trace').style.display='block';; return false;">Application Trace</a> |
    <a href="#" onclick="document.getElementById('Application-Trace').style.display='none';document.getElementById('Full-Trace').style.display='none';document.getElementById('Framework-Trace').style.display='block';; return false;">Framework Trace</a> |
    <a href="#" onclick="document.getElementById('Application-Trace').style.display='none';document.getElementById('Framework-Trace').style.display='none';document.getElementById('Full-Trace').style.display='block';; return false;">Full Trace</a> 
    <div id="Application-Trace" style="display: block;">
		 
 
<div class="entry">
 
  <div class="entrytitle">
    <h2><a href="/2008/11/06/ruby-on-rails-and-oracle-on-mac-os-leopard-2.html">Ruby on Rails and Oracle on Mac Os Leopard</a> <span class="author">Elad Meidar</span></h2> 
    <h3>06 Nov 2008</h3>
  </div>
  
  <div class="entrybody">
    <h3>Overview</h3><p><br />The nightmare is over.<br />Just until the latest Oracle libraries update (finally released a X86 library pack for mac) it was nesecerry to use 2 versions of ruby, a universal and a ppc version. Sadly, when running <span class="caps"><span class="caps">PPC</span></span>, the benchmarking were terrible and it had some very annoying freezes and other stuff that would simple make you want to jump off the roof.<br /><span class="caps"><span class="caps">BUT</span></span>! (:) ) times had changed, Oracle (as mentioned) released an X86 Intel compatible library pack for MacOs users and therefore ended my misery, <br />Woohoo! That makes the entire process of connection Ruby on Rails and oracle on Leopard about as 100 times less complicated than before, so I’ve posted it here to let everyone enjoy. <br />I assumes that you’re using Rails 2.0 or greater (Why not really?). <br /><br /><strong><span class="caps"><span class="caps">IMPORTART</span></span>!!!</strong><br /><em><br />If you already connected Oracle and Ruby on Rails using the old way, please preform the &#8220;Cleanup&#8221; step first.<br /></em><br /><br /><h3>Oracle Libraries</h3><p><br />The new Intel Mac versions are available from the <a href="http://www.oracle.com/technology/software/tech/oci/instantclient/htdocs/intel_macsoft.html">Oracle downloads site</a>. Install them in /Library/Oracle/. <br />You can do side-by-side installations in folders with whatever names you want, since apps find them by using the $ORACLE_HOME environment variable (and it’s friends). I’ve got mine in /Library/Oracle/instantclient_10_2. <br />Also make sure that you’ve got the files required to run <span style="font-weight:bold;">sqlplus</span> and the <span style="font-weight:bold;">sdk</span> along with the <span style="font-weight:bold;">basic</span>. You can drop those in the same directory.<br /><br /><h4>Symlink the libraries</h4><br /><br />In the directory where you’ve installed the instant client, run this:<br /><br /><pre><br />ln -s libclntsh.dylib.10.1 libclntsh.dylib<br /></pre><br /><br />Set the environment variables correctly<br /><br />You’ll probably want to put these lines in your /etc/profile , but they also must be run from the command line to take effect (you can also &#8220;source /etc/profile&#8221;):<br /><br /><pre><br />export ORACLE_HOME=/Library/Oracle/instantclient_10_2 &lt;= Change to your library!<br />export TNS_ADMIN=$ORACLE_HOME<br />export LD_LIBRARY_PATH=$ORACLE_HOME<br />export DYLD_LIBRARY_PATH=$ORACLE_HOME<br />export <span class="caps"><span class="caps">PATH</span></span>=$<span class="caps"><span class="caps">PATH</span></span>:$ORACLE_HOME<br /></pre><br /><br /><br /><h3>Oracle! giddie up!</h3><br /><br />First you&#8217;ll need to install the Active Record Oracle adapter,<br /><br /><pre><br />sudo gem install activerecord-oracle-adapter &#8212;source http://gems.rubyonrails.org<br /></pre><br /><br />which is how ActiveRecord deals with Oracle. <br />It doesn’t, however, install the <span style="font-weight:bold;">Ruby oci8 driver</span>, which is how Ruby talks to Oracle (yeah, annoying). <br /><br /><strong>Important!!!</strong><br /><em><br />Have you installed the Oracle Instant Client <span class="caps"><span class="caps">SDK</span></span> ?<br />good.<br /></em><br /><br />Get the lastest the oci8 library. <a href="http://rubyforge.org/frs/download.php/41042/ruby-oci8-1.0.3.tar.gz">Download</a> it and unpack the file in the finder: it should unzip into ~/Downloads/ruby-oci8-x.&#215;.&#215;.<br /><br />Now we can finish configuring the environment before we compile the library.<br /><br /><pre><br />cd ~/Downloads/ruby-oci8-x.&#215;.x<br />export <span class="caps"><span class="caps">SQLPATH</span></span>=$ORACLE_HOME<br />export RC_ARCHS=i386<br />ruby setup.rb config<br />make<br />sudo make install<br /></pre><br /><br />oh joy, scrolling lines of doom will pass in front of you and hopefully you&#8217;ll see no errors and burst into tears.<br /><br /><h3>Show me!</h3><br /><br />At this point, we’re almost done. Let&#8217;s see it working.<br /><br /><pre><br />irb<br />require &#8216;oci8&#8217;<br />&gt; true<br /></pre><br />or<br /><pre><br />irb<br />require &#8216;rubygems&#8217;<br />&gt; []<br />require &#8216;oci8&#8217;<br />&gt; true<br /></pre><br /><br /><br /><h3>Configure your database.yml</h3><br />In your database.yml, use the following to make it work:<br /><pre><br />development:<br />adapter: oracle<br />database: your_instance_name<br />username: your_user_name<br />password: your_password<br /></pre><br /><br />The database name = &gt; comes straight out of your tnsnames.ora file. You don’t need to specify any other connection information in database.yml, since the tnsnames.ora file has everything you need.<br /><br />if you are using the oracle Express edition, it should look something like that.<br /><pre><br />development:<br />  adapter: oci<br />  host: //db_hostname:db_port/xe &lt; Oracle port is usually 1521<br />  username: username<br />  password: password<br />  cursor_sharing: similar<br />  prefetch_rows: 100<br /></pre><br /><br />note: last 2 lines are some tweaking for a better Oracle performance.<br /><br /><br /><br /><h3>Cleanup: Fix the ruby_fat and ruby_ppc setup</h3><br /><br />if you have installed Oracle libraries using the old way, you&#8217;ll be happy to remove the mess it made out of your ruby installation and happily, it’s quite simple. <br />Just remove the ruby_ppc files, and the symlinks to them (called ruby, and rename ruby_fat as ruby:<br /><br /><pre><br />cd /usr/bin &lt;== or wherever you put them.<br />sudo rm ruby<br />sudo rm ruby_ppc<br />sudo mv ruby_fat ruby<br /></pre><br />and<br /><pre><br />cd /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin<br />sudo rm ruby<br />sudo rm ruby_ppc<br />sudo mv ruby_fat ruby<br /></pre><br /><br />Then, you should also remove the 2 management scripts:<br /><br /><pre><br />sudo rm /usr/bin/ppc_ruby.sh<br />sudo rm /usr/bin/fat_ruby.sh<br /></pre><br /><br />And that’s enough for the cleanup.</p></p>
  </div>
  
  <div id="related">
    <h2>Related Posts</h2>
    <ul class="posts">
      
        <li><span>04 Nov 2009</span> &raquo; <a href="/2009/11/04/bag-o-links-3-11-2009.html">Bag O' Links - 3/11/2009</a></li>
      
        <li><span>30 Oct 2009</span> &raquo; <a href="/2009/10/30/bag-o-links-30-10-2009.html">Bag O' Links - 30/10/2009</a></li>
      
        <li><span>28 Oct 2009</span> &raquo; <a href="/2009/10/28/using-blackbird-javascript-console-in-rails.html">Using BlackBird javascript console in Rails</a></li>
      
    </ul>
  </div>
  
  
</div>
    </div>
    <div id="Framework-Trace" style="display: none;">
    </div>
  
    <div id="Full-Trace" style="display: none;">
		<div id="twitter_div">
			<ul id="twitter_update_list"></ul>
		</div>
    </div>
</div>

<h2 style="margin-top: 30px">Request</h2>
<p><b>Parameters</b>: <pre>None</pre></p>

<p><a href="#" onclick="document.getElementById('session_dump').style.display='block'; return false;">Show session dump</a></p>
<div id="session_dump" style="display:none"><pre class='debug_dump'>--- 
</pre></div>


<h2 style="margin-top: 30px">Response</h2>
<p><b>Headers</b>: <pre>{&quot;Content-Type&quot;=&gt;&quot;&quot;,
 &quot;Cache-Control&quot;=&gt;&quot;no-cache&quot;}</pre></p>

<script type="text/javascript" src="http://twitter.com/javascripts/blogger.js"></script>
<script type="text/javascript" src="http://twitter.com/statuses/user_timeline/eladmeidar.json?callback=twitterCallback2&amp;count=10"></script>
</body>
</html>